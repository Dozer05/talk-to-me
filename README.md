The main is the player interaction code, where the error is occuring. The sub is the npc interaction code, and is what the main is trying to call.
